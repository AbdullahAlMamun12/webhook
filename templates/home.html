<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    {% load static %}
    <link rel="stylesheet" href="{% static 'style.css' %}">

    <style>
        #log-display {
            overflow-y: auto;
            max-height: 500px; /* Limit the height and add scrollbar */
            background-color: #23272a;  /* Darker background for the log area */
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #4a5568;
            margin-bottom: 20px;
            font-size: 0.9rem;
            line-height: 1.4;
        }
    </style>
    <title>Webhook</title>
</head>
<body>


<div id="root">
    <div role="region" aria-label="Notifications (F8)" tabindex="-1" style="pointer-events: none;">
        <ol tabindex="-1" class="fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]"></ol>
    </div>
    <div class="group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar" style="--sidebar-width: 16rem; --sidebar-width-icon: 3rem;">
        <div class="flex min-h-screen w-full">
            <div class="group peer hidden md:block text-sidebar-foreground" data-state="expanded" data-collapsible="" data-variant="sidebar" data-side="left">
                <div class="duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear group-data-[collapsible=offcanvas]:w-0 group-data-[side=right]:rotate-180 group-data-[collapsible=icon]:w-[--sidebar-width-icon]"></div>
                <div class="duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)] group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l">
                    <div class="flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow" data-sidebar="sidebar">
                        <div class="flex-col gap-2 p-2 py-6 px-3 flex items-center justify-between" data-sidebar="header">
                            <div class="flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-webhook-purple" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2"></path>
                                    <path d="m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06"></path>
                                    <path d="m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8"></path>
                                </svg>
                                <h1 class="text-xl font-bold">Echo<span class="text-webhook-purple">Verse</span></h1></div>
                            <button class="gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hidden sm:flex h-6 w-6 items-center justify-center rounded-md text-muted-foreground hover:bg-accent hover:text-accent-foreground" data-sidebar="trigger">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-panel-left">
                                    <rect width="18" height="18" x="3" y="3" rx="2"></rect>
                                    <path d="M9 3v18"></path>
                                </svg>
                                <span class="sr-only">Toggle Sidebar</span></button>
                        </div>
                        <div class="flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden px-2" data-sidebar="content">
                            <div class="relative flex w-full min-w-0 flex-col p-2" data-sidebar="group">
                                <div class="duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0" data-sidebar="group-label">
                                    Webhook
                                </div>
                                <div class="w-full text-sm" data-sidebar="group-content">
                                    <ul class="flex w-full min-w-0 flex-col gap-1" data-sidebar="menu">
                                        <li class="group/menu-item relative" data-sidebar="menu-item"><a class="peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-none ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent hover:text-sidebar-accent-foreground h-8 text-sm flex gap-2 items-center" data-sidebar="menu-button" data-size="default" data-active="false" href="http://localhost:8080/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" width="24"
                                                 height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2"></path>
                                                <path d="m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06"></path>
                                                <path d="m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8"></path>
                                            </svg>
                                            <span>Inspector</span></a>
                                        </li>
                                        <li class="group/menu-item relative" data-sidebar="menu-item"><a class="peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-none ring-sidebar-ring transition-[width,height,padding] focus-visible:outline-none focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent hover:text-sidebar-accent-foreground h-8 text-sm flex gap-2 items-center" data-sidebar="menu-button" data-size="default" data-active="false" href="http://localhost:8080/history">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" width="24"
                                                 height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M3 3v5h5"></path>
                                                <path d="M3 3 8 8"></path>
                                                <path d="M21 21v-5h-5"></path>
                                                <path d="M21 21-6-6"></path>
                                                <path d="M21 3v5h-5"></path>
                                                <path d="M21 3l-5 5"></path>
                                                <path d="M3 21v-5h5"></path>
                                                <path d="m3 21 5-5"></path>
                                            </svg>
                                            <span>History</span></a>
                                        </li>
                                        <li class="group/menu-item relative" data-sidebar="menu-item"><a class="peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-none ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent hover:text-sidebar-accent-foreground h-8 text-sm flex gap-2 items-center" data-sidebar="menu-button" data-size="default" data-active="false" href="http://localhost:8080/settings">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" width="24"
                                                 height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
                                                <circle cx="12" cy="12" r="3"></circle>
                                            </svg>
                                            <span>Settings</span></a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col gap-2 p-4" data-sidebar="footer">
                            <div class="w-full">
                                <button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 text-primary-foreground h-10 px-4 py-2 w-full bg-webhook-purple hover:bg-webhook-purple/90">
                                    New Endpoint
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex-1 overflow-auto">
                <div class="p-4 md:p-6 h-screen flex flex-col">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                        <h1 class="text-2xl font-bold">Webhook Inspector</h1>
                        <div class="flex gap-2">
                            <button id="live-mode-button"
                                    class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 border border-input hover:text-accent-foreground h-10 px-4 py-2 bg-background hover:bg-accent text-muted-foreground">
                                <span class="mr-2 badge-ping false"></span>Live Mode OFF
                            </button>
                            <button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 text-muted-foreground">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" width="24" height="24"
                                     viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                     stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M3 6h18"></path>
                                    <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                                    <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                                </svg>
                                Clear
                            </button>
                        </div>
                    </div>
                    <div class="rounded-lg border text-card-foreground border-webhook-border-gray bg-card shadow-sm mb-6">
                        <div class="p-4">
                            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-4">
                                <div class="flex-grow">
                                    <div class="text-xs uppercase text-webhook-text-gray mb-1">Your Webhook URL</div>
                                    <div id="current-origin"  class="font-mono text-sm sm:text-base overflow-auto truncate max-w-full px-2 py-1 bg-muted rounded">
                                        https://echoverseapp.io/tf8a5dga
                                    </div>
                                </div>
                                <button id = "copy-url-button" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 gap-2 min-w-[100px]">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" width="24" height="24"
                                         viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                         stroke-linecap="round" stroke-linejoin="round">
                                        <rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect>
                                        <path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path>
                                    </svg>
                                    <span>Copy URL</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 flex-grow overflow-hidden">
                        <div class="h-[calc(100vh-280px)] md:h-auto">
                            <div class="rounded-lg border text-card-foreground shadow-sm border-webhook-border-gray bg-card h-full flex flex-col">
                                <div class="flex flex-col space-y-1.5 p-6 py-3 px-4 border-b border-border">
                                    <div class="flex items-center justify-between"><h3
                                            class="tracking-tight text-base font-medium">Requests</h3><span
                                            class="text-xs text-muted-foreground font-mono">8 Requests</span></div>
                                </div>

                                <div class="p-0 flex-grow overflow-hidden">
                                    <div  dir="ltr"  id="log-display" class="relative overflow-hidden h-full"
                                          style="position: relative; --radix-scroll-area-corner-width: 0px; --radix-scroll-area-corner-height: 0px;">
                                        <style>
                                            [data-radix-scroll-area-viewport] {
                                                scrollbar-width: none;
                                                -ms-overflow-style: none;
                                                -webkit-overflow-scrolling: touch;
                                            }

                                            :where([data-radix-scroll-area-viewport]) {
                                                display: flex;
                                                flex-direction: column;
                                                align-items: stretch;
                                            }

                                            :where([data-radix-scroll-area-content]) {
                                                flex-grow: 1;
                                            }
                                        </style>
                                        <div data-radix-scroll-area-viewport="" class="h-full w-full rounded-[inherit]" style="overflow: hidden scroll;">
                                            <div data-radix-scroll-area-content="">
                                                <div class="divide-y divide-border" id="log-list">
                                                    <div class="p-3 border-b border-border cursor-pointer hover:bg-muted/30 transition-colors">
                                                        <div class="flex items-center justify-between">
                                                            <div class="flex items-center gap-2">
                                                                <div class="inline-flex items-center border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent text-primary-foreground hover:bg-primary/80 bg-blue-600 rounded font-mono">
                                                                    GET
                                                                </div>
                                                                <span class="font-mono text-sm truncate max-w-[200px]">/api/notification</span>
                                                            </div>
                                                            <div class="text-xs text-webhook-text-gray">about 1 hour ago
                                                            </div>
                                                        </div>
                                                        <div class="flex items-center justify-between mt-2">
                                                            <div class="text-xs text-webhook-text-gray">text/plain
                                                            </div>
                                                            <div class="text-xs text-webhook-text-gray">1.5 KB
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="p-3 border-b border-border cursor-pointer hover:bg-muted/30 transition-colors">
                                                        <div class="flex items-center justify-between">
                                                            <div class="flex items-center gap-2">
                                                                <div class="inline-flex items-center border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent text-primary-foreground hover:bg-primary/80 bg-green-600 rounded font-mono">
                                                                    POST
                                                                </div>
                                                                <span class="font-mono text-sm truncate max-w-[200px]">/api/webhook</span>
                                                            </div>
                                                            <div class="text-xs text-webhook-text-gray">about 2 hours
                                                                ago
                                                            </div>
                                                        </div>
                                                        <div class="flex items-center justify-between mt-2">
                                                            <div class="text-xs text-webhook-text-gray">text/plain
                                                            </div>
                                                            <div class="text-xs text-webhook-text-gray">7.5 KB
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="p-3 border-b border-border cursor-pointer hover:bg-muted/30 transition-colors">
                                                        <div class="flex items-center justify-between">
                                                            <div class="flex items-center gap-2">
                                                                <div class="inline-flex items-center border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent text-primary-foreground hover:bg-primary/80 bg-yellow-600 rounded font-mono">
                                                                    PUT
                                                                </div>
                                                                <span class="font-mono text-sm truncate max-w-[200px]">/api/webhook</span>
                                                            </div>
                                                            <div class="text-xs text-webhook-text-gray">about 3 hours
                                                                ago
                                                            </div>
                                                        </div>
                                                        <div class="flex items-center justify-between mt-2">
                                                            <div class="text-xs text-webhook-text-gray">
                                                                application/x-www-form-urlencoded
                                                            </div>
                                                            <div class="text-xs text-webhook-text-gray">6.4 KB
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="p-3 border-b border-border cursor-pointer hover:bg-muted/30 transition-colors">
                                                        <div class="flex items-center justify-between">
                                                            <div class="flex items-center gap-2">
                                                                <div class="inline-flex items-center border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent text-primary-foreground hover:bg-primary/80 bg-red-600 rounded font-mono">
                                                                    DELETE
                                                                </div>
                                                                <span class="font-mono text-sm truncate max-w-[200px]">/api/event</span>
                                                            </div>
                                                            <div class="text-xs text-webhook-text-gray">about 9 hours
                                                                ago
                                                            </div>
                                                        </div>
                                                        <div class="flex items-center justify-between mt-2">
                                                            <div class="text-xs text-webhook-text-gray">application/xml
                                                            </div>
                                                            <div class="text-xs text-webhook-text-gray">3.3 KB
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="p-3 border-b border-border cursor-pointer hover:bg-muted/30 transition-colors">
                                                        <div class="flex items-center justify-between">
                                                            <div class="flex items-center gap-2">
                                                                <div class="inline-flex items-center border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent text-primary-foreground hover:bg-primary/80 bg-purple-600 rounded font-mono">
                                                                    PATCH
                                                                </div>
                                                                <span class="font-mono text-sm truncate max-w-[200px]">/api/user</span>
                                                            </div>
                                                            <div class="text-xs text-webhook-text-gray">about 10 hours
                                                                ago
                                                            </div>
                                                        </div>
                                                        <div class="flex items-center justify-between mt-2">
                                                            <div class="text-xs text-webhook-text-gray">text/plain
                                                            </div>
                                                            <div class="text-xs text-webhook-text-gray">9.3 KB
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="h-[calc(100vh-280px)] md:h-auto">
                            <div class="rounded-lg border text-card-foreground shadow-sm border-webhook-border-gray bg-card h-full flex items-center justify-center">
                                <div class="text-center p-6">
                                    <div class="mx-auto flex items-center justify-center w-12 h-12 rounded-full bg-muted mb-4">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-webhook-purple" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2"></path>
                                            <path d="m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06"></path>
                                            <path d="m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8"></path>
                                        </svg>
                                    </div>
                                    <h3 class="text-lg font-medium mb-2">Welcome to EchoVerse</h3>
                                    <p class="text-muted-foreground max-w-md">Your personal webhook inspector. Send
                                        requests to your
                                        unique URL and they'll appear here in real-time.</p></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
        const originElement = document.getElementById('current-origin');
        if (originElement) {
            originElement.textContent = window.location.origin + "/" + "{{ session_id }}";
        }

        function showToast(message) {
            const toast = document.createElement('div');
            toast.classList.add('toast');
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        const copyUrlButton = document.getElementById('copy-url-button');
        if (copyUrlButton) {
            copyUrlButton.addEventListener('click', function() {
                const urlToCopy = originElement.textContent;
                navigator.clipboard.writeText(urlToCopy).then(function() {
                    alert('URL copied to clipboard!');
                }).catch(function(err) {
                    alert('Failed to copy URL: ' + err);
                });
            });
        }

        // WebSocket implementation
        const requestList = document.getElementById('log-list');
        const sessionId = '279d4c37-d8e6-47d6-b83a-d72d00f65894'; // Replace with your actual session ID
        const wsUrl = `ws://localhost:8000/ws/logs/${sessionId}/`;
        let socket = null;

        const liveModeButton = document.getElementById('live-mode-button');
        let isConnected = false;

        function updateLiveModeButton() {
            if (isConnected) {
                liveModeButton.innerHTML = '<span class="mr-2 badge-ping false"></span>Live Mode ON'
                liveModeButton.classList.remove('bg-background', 'hover:bg-accent', 'text-muted-foreground');
                liveModeButton.classList.add('bg-green-500/20', 'hover:bg-green-500/30');
            }
            else {
                liveModeButton.innerHTML = '<span class="mr-2 badge-ping false"></span>Live Mode OFF'
                liveModeButton.classList.remove('bg-green-500/20', 'hover:bg-green-500/30');
                liveModeButton.classList.add('bg-background', 'hover:bg-accent', 'text-muted-foreground');
            }
        }
        function connectWebSocket() {
            if (!socket || socket.readyState === WebSocket.CLOSED) {
                socket = new WebSocket(wsUrl);

                socket.onopen = () => {
                    isConnected = true;
                    updateLiveModeButton();
                    // logDisplay.className = 'connected';
                    // logDisplay.textContent = 'âœ… Connected to Django WebSocket';
                    addLogEntry({method: 'CONNECT', timestamp: new Date().toISOString(), body: 'Connection established' }, 'status');
                };

                socket.onmessage = (event) => {
                    try {
                        const parsedData = JSON.parse(event.data);
                        addLogEntry(parsedData, 'message');
                    } catch (error) {
                        addLogEntry(`âŒ Error parsing message: ${error.message}`, 'error');
                        addLogEntry(event.data, 'error');
                        console.error('Error parsing WebSocket message', error);
                    }
                };

                socket.onclose = () => {
                    isConnected = false;
                    updateLiveModeButton();
                    // logDisplay.className = 'disconnected';
                    // logDisplay.textContent = 'ðŸ”Œ WebSocket disconnected';
                    addLogEntry('ðŸ”Œ Disconnected from Django WebSocket', 'status');
                };

                socket.onerror = (error) => {
                    isConnected = false;
                    updateLiveModeButton();
                    // logDisplay.className = 'error';
                    // logDisplay.textContent = `âŒ WebSocket error: ${error.message}`;
                    // addLogEntry(`âŒ WebSocket error: ${error.message}`, 'error');
                    console.error('WebSocket error:', error);
                };
            }
        }

        function disconnectWebSocket() {
            if (socket && socket.readyState === WebSocket.OPEN) {
                socket.close();
            }
            isConnected = false;
            updateLiveModeButton();
        }

        liveModeButton.addEventListener('click', () => {
            if (isConnected) {
                disconnectWebSocket();
            } else {
                connectWebSocket();
            }
        });

        function addLogEntry(message, type = 'message') {
            let logEntryContent = '';
            if (type === 'message') {
                let methodColor = '';
                switch (message.method) {
                    case 'GET':
                        methodColor = 'bg-blue-600';
                        break;
                    case 'POST':
                        methodColor = 'bg-green-600';
                        break;
                    case 'PUT':
                        methodColor = 'bg-yellow-600';
                        break;
                    case 'DELETE':
                        methodColor = 'bg-red-600';
                        break;
                    case 'PATCH':
                        methodColor = 'bg-purple-600';
                        break;
                    default:
                        methodColor = 'bg-gray-600';
                }

                logEntryContent = `
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <div class="inline-flex items-center border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent text-primary-foreground hover:bg-primary/80 ${methodColor} rounded font-mono">
                                    ${message.method}
                                </div>
                                <span class="font-mono text-sm truncate max-w-[200px]">${message.path}</span>
                            </div>
                            <div class="text-xs text-webhook-text-gray">${message.timestamp}</div>
                        </div>
                        <div class="flex items-center justify-between mt-2">
                            <div class="text-xs text-webhook-text-gray">${message.content_type}</div>
                            <div class="text-xs text-webhook-text-gray">${message.content_length}</div>
                        </div>
                    `;
            } else if (type === 'status') {
                logEntryContent = message;
            } else if (type === 'error') {
                logEntryContent = message;
            }

            const logEntry = document.createElement('div');
            logEntry.classList.add('log-entry');
            logEntry.innerHTML = logEntryContent;
            requestList.appendChild(logEntry);
            requestList.scrollTop = requestList.scrollHeight;
        }

</script>


</body>
</html>